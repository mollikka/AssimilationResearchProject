# Facebook assimilation research code

Install https://github.com/maraujo/pySocialWatcher and set the Facebook API credentials it uses in ./credentials.txt

## discover_interests.py

This is a tool for performing a snowball search on Facebook's tracked interests, seeded by the letters of the alphabet.

##### Use

Check that the working_folder variable points to something acceptable, and let the script run: ```python2 discover_interests.py```

## discover_audience_size.py

This tool will read the list of Facebook interests as created by discover_interests.py, and query for the audience size of each of those interests in some population. This results in the *interest vector* of that population.
Age ranges, expat status etc. are defined in get_search_param, and country codes are defined by command line parameters.

Each of discover_audience_sizeN.py is just a poorly named copy with a different get_search_param function.
(discover_audience_size.py : native, discover_audience_size2.py : expat, discover_audience_size3.py : Arabic)

##### Use

Check that the working_folder variable points to the folder created by discover_interests.py and

Example run to collect interest vectors for three countries: ```python2 discover_audience_size.py FI,IT,SE```

## analyze.py

A bunch of functions and scripts for analyzing data generated by discover_audience_size.py

##### Loading data

These two lines will load all of the dataframes in SPECIFIC_DATAFRAME_FOLDER and do some preprocessing on them.
```python
data = load_dataframes()
data = generate_helper_columns_on_dataframe()
```

get_interest_vectors will sort the data into 'interest vectors' into the form ```((countrycode,expatstatus,language,gender),interest_vector=[1,5,2,...]), ((countrycode,expatstatus,language,gender),[1,5,2,...]),... ```
```python
vectors = get_interest_vectors(data)
```
where **the interest vector** is an ordered list of numbers, each the audience size of one interest topic in the population (or None if the audience doesn't cross the 1000 people threshold).

For example, you can get the interest vector of Iraq's native Facebook users with
```python
vectors = get_interest_vectors(data)
irak_vector = get_vector(vectors, "IQ", "Not ex-pat", "All", "All")
```


Finally, this, or a similar construct, will create a comparison matrix that can be imported to Excel or LaTeX:
```python
nations = ['GB','NL','CH','FI','IT','SE','HU','AT','FR','DE']
vectors = [i for i in vectors if i[0][0] in nations]

mypairs_collection = generate_country_comparison_matrix(nations, vectors)
```

At the end of the analyze.py script, I've included several export table functions commented out.


##### Use

Check that the GLOBAL_DATAFRAME_FOLDER variable points to the folder created by discover_interests.py and
SPECIFIC_DATAFRAME_FOLDER points to a folder where you've moved all of the dataframes collected by discover_audience_size.py
(and nothing else)

